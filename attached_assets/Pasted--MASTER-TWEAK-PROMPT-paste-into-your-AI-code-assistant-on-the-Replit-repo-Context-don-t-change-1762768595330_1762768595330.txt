üîß MASTER TWEAK PROMPT (paste into your AI code assistant on the Replit repo)

Context (don‚Äôt change):
I have a running rally game on Replit (static web build). It‚Äôs a simple 3D endless road racer (likely Three.js or similar) with a car, a straight road mesh that curves, a dark scene, a HUD (distance/speed/jars/score), pause, and a ‚ÄúTuning‚Äù button. Assets include a Dream Nexus logo and a Pixel the Bunny sprite/icon. The current issues are:

Steering left/right kills or resets speed (feels broken).

Acceleration decays too much; keeping speed requires spamming Up.

Road visuals and lighting are too dark; world looks empty.

Menu/UI looks messy and unbranded.

Collectibles (arequipe jars) don‚Äôt give satisfying feedback.

Performance occasionally stutters.

Goal:
Tweak the existing code in-place (no rewrite, no new framework) so it plays like a snappy arcade racer. Keep the project Replit-friendly (plain HTML/CSS/JS). If the project uses Three.js, keep using it. If it‚Äôs raw canvas, keep that. Do not convert to another engine. Keep all filenames and folder structure unless I explicitly ask to rename.

Required changes (incremental, in place)
1) Driving feel (no speed reset on steer)

Separate throttle/brake from steering. Turning must not zero speed.

Implement simple arcade curves:

// targetSpeed gets pushed by input; actualSpeed eases toward it
targetSpeed = clamp(targetSpeed + accelInput * ACCEL_RATE * dt - brakeInput * BRAKE_RATE * dt, 0, MAX_SPEED);
actualSpeed += (targetSpeed - actualSpeed) * 0.12; // easing, tweakable

// steering uses yaw velocity; never modifies targetSpeed directly
yawVelocity = lerp(yawVelocity, steerInput * STEER_STRENGTH * (0.7 + 0.3 * actualSpeed/MAX_SPEED), 0.15);
carYaw += yawVelocity * dt;


If the car goes off road, apply soft friction (e.g., multiply actualSpeed by 0.985 per frame off-road) rather than a hard stop.

2) Road generation & fairness

Keep the road flat and grounded (no tube).

Curve limits: limit turn radius so consecutive curves don‚Äôt become roller-coaster.

Add gentle elevation waves (¬±2‚Äì3m over ~100m) for variety; camera pitch can ease slightly with elevation.

Ensure the spawn system never creates unavoidable obstacles.

3) Lighting & vibe

Brighten the scene: key directional light + subtle ambient light.

Use a sky gradient (GPU-cheap) instead of a black sky.

Add low-poly wax palms and mountains; randomize spacing; use frustum culling or simple distance culling for performance.

4) Collectibles & feedback

Arequipe jars: on pickup ‚Üí

+1 to jars, score += 50, tiny speed burst (targetSpeed += burst, clamped).

UI pop, sound pickup.wav, and a 0.2s scale tween on the jar before despawn.

Add a centerline ‚Äúcombo trail‚Äù glow that intensifies slightly with combo pickups (resets after crash/slowdown).

5) HUD, Pause & High score

Keep the current HUD fields but move to a clean top-left card.

High score persists with localStorage keys: dnr_highscore, dnr_bestjars.

Pause (P) must freeze simulation time but not the render loop; show a branded pause overlay.

6) Replit-safe performance

One requestAnimationFrame loop only.

Avoid per-frame object creation; reuse vectors/arrays.

Cull scenery > 1200m from the camera (or keep a small pooled set and reposition ahead).

Make sure assets are small; compress images. No huge GLBs unless already present.

7) Menu polish (new HTML/CSS below)

Replace the current menu with the drop-in section I provide at the end.

The menu must load fast and not block WebGL initialization.

Parameters to expose (so I can tune from a small ‚ÄúTuning‚Äù panel)
const TUNE = {
  MAX_SPEED: 180,         // km/h
  ACCEL_RATE: 55,         // per second
  BRAKE_RATE: 90,         // per second
  STEER_STRENGTH: 2.2,    // base yaw factor
  OFFROAD_DRAG: 0.985,    // per-frame multiplier when off-road
  CURVE_INTENSITY: 0.7,   // 0..1
  HILL_INTENSITY: 0.35,   // 0..1
  PICKUP_BURST: 8,        // adds to targetSpeed (km/h), clamped
  AMBIENT_INTENSITY: 0.45,
  SUN_INTENSITY: 1.2
};

Acceptance checklist (use this to verify before you stop)

Holding LEFT/RIGHT no longer drops speed by more than 10%.

Keeping UP held reaches >120 km/h within ~3 seconds.

Off-road slows the car gradually; returning to road restores normal grip/speed.

Jars give sound + score + brief speed burst and show a quick UI pop.

Menu + HUD look like the provided styles; high score persists after reload.

No new dependencies; still runs on Replit with the project‚Äôs current stack.

What to edit (file-level guidance)

index.html: replace menu markup with the block I provide below; keep the canvas and existing script tags.

styles.css: append the menu/HUD CSS below.

Main game script (e.g., main.js or game.js): implement the driving, road, lighting, collectibles, and localStorage changes as above.

Don‚Äôt change file names or paths unless absolutely required.

After making changes, produce a concise diff-style summary of exactly which files/lines were touched so I can review.

üìã DROP-IN MENU + HUD (copy into your files)
1) HTML (put inside <body> before your canvas)
<!-- Dream Nexus Rally ‚Äì Branded Menu -->
<div id="dnr-app">
  <div id="dnr-menu" class="dnr-screen active">
    <div class="dnr-card">
      <img src="dream_nexus_logo.svg" alt="Dream Nexus" class="dnr-logo" />
      <h1>Dream Nexus Rally</h1>
      <div class="dnr-hero">
        <img src="pixel_bunny.png" alt="Pixel the Bunny" />
      </div>
      <p class="dnr-sub">Help Pixel race through Colombia</p>

      <div class="dnr-controls">
        <div><kbd>W</kbd>/<kbd>‚Üë</kbd> Accelerate</div>
        <div><kbd>S</kbd>/<kbd>‚Üì</kbd> Brake</div>
        <div><kbd>A</kbd>/<kbd>‚Üê</kbd> Left &nbsp; <kbd>D</kbd>/<kbd>‚Üí</kbd> Right</div>
        <div><kbd>P</kbd> Pause</div>
      </div>

      <button id="dnr-start" class="dnr-btn">Start (Enter)</button>
      <div class="dnr-sponsor">Sponsored by Dream Nexus</div>
    </div>
  </div>

  <!-- HUD -->
  <div id="dnr-hud" class="dnr-hud hidden">
    <div class="dnr-hud-card">
      <div>Distance: <span id="hud-distance">0m</span></div>
      <div>Speed: <span id="hud-speed">0 km/h</span></div>
      <div>Arequipe Jars: <span id="hud-jars">0</span></div>
      <div>Score: <span id="hud-score">0</span></div>
      <div>High Score: <span id="hud-high">0</span></div>
    </div>
    <div class="dnr-top-right">
      <button id="dnr-pause" class="dnr-chip">Pause (P)</button>
      <button id="dnr-tune" class="dnr-chip">Tuning</button>
      <button id="dnr-mute" class="dnr-chip">üîä</button>
    </div>
  </div>

  <!-- Pause Overlay -->
  <div id="dnr-pause-overlay" class="dnr-overlay hidden">
    <div class="dnr-card">
      <h2>Paused</h2>
      <div class="dnr-grid">
        <label>Sensitivity
          <input id="ui-steer" type="range" min="1.0" max="3.5" step="0.1" />
        </label>
        <label>Max Speed
          <input id="ui-max" type="range" min="100" max="220" step="5" />
        </label>
      </div>
      <div class="dnr-actions">
        <button id="dnr-resume" class="dnr-btn">Resume</button>
        <button id="dnr-restart" class="dnr-btn ghost">Restart</button>
        <button id="dnr-home" class="dnr-btn ghost">Main Menu</button>
      </div>
    </div>
  </div>
</div>

2) CSS (append to styles.css)
:root {
  --dnr-cyan:#24A0CE; --dnr-pink:#FDC6B5; --dnr-ink:#0e1a22; --dnr-card:#12232c; --dnr-muted:#6fa7bc;
}
#dnr-app { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:#e9f6fb; }
.dnr-screen { position:fixed; inset:0; display:grid; place-items:center; background:radial-gradient(1200px 600px at 50% 10%, rgba(36,160,206,.15), transparent), linear-gradient(#081319,#0c151b); z-index:10; }
.dnr-screen.hidden{ display:none; }
.dnr-card{ background:var(--dnr-card); border:1px solid rgba(255,255,255,.06); padding:28px; border-radius:18px; box-shadow:0 20px 60px rgba(0,0,0,.45); width:min(520px,92vw); text-align:center; }
.dnr-logo{ width:160px; opacity:.95; margin-bottom:10px; }
h1{ margin:8px 0 6px; font-weight:800; letter-spacing:.5px; color:#c9f1ff; }
.dnr-sub{ color:var(--dnr-muted); margin:4px 0 18px; }
.dnr-hero img{ width:84px; filter:drop-shadow(0 6px 16px rgba(36,160,206,.35)); }
.dnr-controls{ display:grid; gap:6px; margin:10px 0 16px; font-size:14px; color:#d7eaf2; }
kbd{ background:#0b1b22; border:1px solid rgba(255,255,255,.1); border-bottom-color:rgba(0,0,0,.3); padding:3px 6px; border-radius:6px; box-shadow:inset 0 -2px 0 rgba(0,0,0,.3); }
.dnr-btn{ display:inline-block; padding:12px 18px; border-radius:12px; border:none; font-weight:700; letter-spacing:.2px; background:linear-gradient(180deg, #2cc0ef, #24A0CE); color:#061319; cursor:pointer; }
.dnr-btn.ghost{ background:transparent; color:#c9f1ff; border:1px solid rgba(255,255,255,.12); }
.dnr-btn:hover{ filter:brightness(1.06); }
.dnr-sponsor{ margin-top:8px; font-size:12px; color:#a9d2df; opacity:.9; }

.dnr-hud{ position:fixed; inset:0; pointer-events:none; z-index:9; }
.dnr-hud.hidden{ display:none; }
.dnr-hud-card{ position:absolute; top:14px; left:14px; background:rgba(8,20,26,.7); border:1px solid rgba(255,255,255,.08); padding:10px 12px; border-radius:12px; backdrop-filter: blur(4px); }
.dnr-top-right{ position:absolute; top:12px; right:12px; display:flex; gap:8px; }
.dnr-chip{ pointer-events:auto; background:#102029; border:1px solid rgba(255,255,255,.1); color:#dff7ff; border-radius:999px; padding:6px 10px; cursor:pointer; }
.dnr-chip:hover{ border-color:rgba(255,255,255,.2); }

.dnr-overlay{ position:fixed; inset:0; display:grid; place-items:center; backdrop-filter: blur(4px); background:rgba(6,14,18,.55); z-index:11; }
.hidden{ display:none !important; }
.dnr-grid{ display:grid; grid-template-columns:1fr 1fr; gap:14px; text-align:left; margin:12px 0; }
.dnr-actions{ display:flex; gap:10px; justify-content:center; }

3) Minimal JS hooks (add or merge in your main script)
// --- Menu/HUD wiring (keep your existing game init; just hook these) ---
const menuEl = document.getElementById('dnr-menu');
const hudEl  = document.getElementById('dnr-hud');
const pauseOverlay = document.getElementById('dnr-pause-overlay');
const startBtn = document.getElementById('dnr-start');
const pauseBtn = document.getElementById('dnr-pause');
const resumeBtn = document.getElementById('dnr-resume');
const restartBtn= document.getElementById('dnr-restart');
const homeBtn   = document.getElementById('dnr-home');
const muteBtn   = document.getElementById('dnr-mute');

const hudDistance = document.getElementById('hud-distance');
const hudSpeed    = document.getElementById('hud-speed');
const hudJars     = document.getElementById('hud-jars');
const hudScore    = document.getElementById('hud-score');
const hudHigh     = document.getElementById('hud-high');

let paused = false;
let audioMuted = false;

// persist high score
function getHigh(){ return +localStorage.getItem('dnr_highscore')||0; }
function setHigh(v){ localStorage.setItem('dnr_highscore', String(v)); }
hudHigh.textContent = getHigh();

function showGame(){ menuEl.classList.add('hidden'); hudEl.classList.remove('hidden'); }
function showMenu(){ menuEl.classList.remove('hidden'); hudEl.classList.add('hidden'); pauseOverlay.classList.add('hidden'); paused=false; }

startBtn?.addEventListener('click', () => { showGame(); /* call your game start/init here */ });
document.addEventListener('keydown', e => { if(e.key === 'Enter' && !paused && !hudEl.classList.contains('hidden')) return; if(e.key==='Enter' && !hudEl || menuEl && !menuEl.classList.contains('hidden')) startBtn.click(); });

pauseBtn?.addEventListener('click', () => togglePause(true));
resumeBtn?.addEventListener('click', () => togglePause(false));
homeBtn  ?.addEventListener('click', () => { showMenu(); /* reset run state */ });
restartBtn?.addEventListener('click', () => { togglePause(false); /* soft reset current run */ });

function togglePause(on){
  paused = !!on;
  pauseOverlay.classList.toggle('hidden', !paused);
  // in your loop: if (paused) return; (skip simulation but keep render)
}

muteBtn?.addEventListener('click', () => {
  audioMuted = !audioMuted;
  muteBtn.textContent = audioMuted ? 'üîà' : 'üîä';
  // route this to your audio mixer or set gain nodes to 0/1
});

// update HUD from your game each frame:
function updateHUD({distance, speed, jars, score}) {
  hudDistance.textContent = `${Math.floor(distance)}m`;
  hudSpeed.textContent = `${Math.round(speed)} km/h`;
  hudJars.textContent = jars;
  hudScore.textContent = score;
  if (score > getHigh()) { setHigh(score); hudHigh.textContent = score; }
}
window.DNR_UPDATE_HUD = updateHUD; // expose for your game code


In your main loop, call window.DNR_UPDATE_HUD({ distance, speed, jars, score }).

Final notes for the AI (keep this in the prompt)

Do not introduce new build steps; this must still run with Replit‚Äôs static server.

Keep bundle size small; compress textures; prefer simple low-poly over heavy assets.

Provide a short ‚ÄúWhat changed‚Äù list at the end: files + main edits.